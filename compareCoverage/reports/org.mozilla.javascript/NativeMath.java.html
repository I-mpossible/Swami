<?xml version='1.0' encoding='UTF-8'?><!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Strict//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd'><html xmlns='http://www.w3.org/1999/xhtml' lang='en'><head><meta http-equiv='Content-Type' content='text/html;charset=UTF-8'/><title>org.mozilla.javascript.NativeMath.java</title><link rel='stylesheet' href='../.resources/report.css' type='text/css'/><link rel='stylesheet' href='../.resources/prettify.css' type='text/css'/><link rel='stylesheet' href='../.resources/custom.css' type='text/css'/><script type='text/javascript' src='../.resources/prettify.js'></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><h1>org.mozilla.javascript.NativeMath.java</h1><table class='legend'><tr><td class='nc'>Not Covered</td><td class='ac'>Covered by test suite 1</td><td class='bc'>Covered by test suite 2</td><td class='uc'>Covered by the union test suite</td><td class='apc'>Partially Covered by test suite 1</td><td class='bpc'>Partially Covered by test suite 2</td><td class='upc'>Partially Covered by the union test suite</td></tr></table><pre class='source lang-java linenums'>/* -*- Mode: java; tab-width: 4; indent-tabs-mode: 1; c-basic-offset: 4 -*-
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

package org.mozilla.javascript;

import org.mozilla.javascript.typedarrays.Conversions;

/**
 * This class implements the Math native object.
 * See ECMA 15.8.
 * @author Norris Boyd
 */

final class NativeMath extends IdScriptableObject
{
    static final long serialVersionUID = -8838847185801131569L;

<span class='uc' id='L21' title='3|3|3 - Total: 3'>    private static final Object MATH_TAG = "Math";
</span>
    static void init(Scriptable scope, boolean sealed)
    {
<span class='uc' id='L25' title='4|4|4 - Total: 4'>        NativeMath obj = new NativeMath();
</span><span class='uc' id='L26' title='3|3|3 - Total: 3'>        obj.activatePrototypeMap(MAX_ID);
</span><span class='uc' id='L27' title='4|4|4 - Total: 4'>        obj.setPrototype(getObjectPrototype(scope));
</span><span class='uc' id='L28' title='3|3|3 - Total: 3'>        obj.setParentScope(scope);
</span><span class='uc' id='L29' title='2|2|2 - Total: 2'>        if (sealed) { obj.sealObject(); }
</span><span class='uc' id='L30' title='5|5|5 - Total: 5'>        ScriptableObject.defineProperty(scope, "Math", obj,
</span>                                        ScriptableObject.DONTENUM);
<span class='uc' id='L32' title='1|1|1 - Total: 1'>    }
</span>
    private NativeMath()
<span class='uc' id='L35' title='2|2|2 - Total: 2'>    {
</span><span class='uc' id='L36' title='1|1|1 - Total: 1'>    }
</span>
    @Override
<span class='uc' id='L39' title='2|2|2 - Total: 2'>    public String getClassName() { return "Math"; }
</span>
    @Override
    protected void initPrototypeId(int id)
    {
<span class='uc' id='L44' title='2|2|2 - Total: 2'>        if (id <= LAST_METHOD_ID) {
</span>            String name;
            int arity;
<span class='upc' id='L47' title='29|29|29 - Total: 30'>            switch (id) {
</span><span class='uc' id='L48' title='5|5|5 - Total: 5'>              case Id_toSource: arity = 0; name = "toSource"; break;
</span><span class='uc' id='L49' title='5|5|5 - Total: 5'>              case Id_abs:      arity = 1; name = "abs";      break;
</span><span class='uc' id='L50' title='5|5|5 - Total: 5'>              case Id_acos:     arity = 1; name = "acos";     break;
</span><span class='uc' id='L51' title='5|5|5 - Total: 5'>              case Id_asin:     arity = 1; name = "asin";     break;
</span><span class='uc' id='L52' title='5|5|5 - Total: 5'>              case Id_atan:     arity = 1; name = "atan";     break;
</span><span class='uc' id='L53' title='5|5|5 - Total: 5'>              case Id_atan2:    arity = 2; name = "atan2";    break;
</span><span class='uc' id='L54' title='5|5|5 - Total: 5'>              case Id_cbrt:     arity = 1; name = "cbrt";     break;
</span><span class='uc' id='L55' title='5|5|5 - Total: 5'>              case Id_ceil:     arity = 1; name = "ceil";     break;
</span><span class='uc' id='L56' title='5|5|5 - Total: 5'>              case Id_cos:      arity = 1; name = "cos";      break;
</span><span class='uc' id='L57' title='5|5|5 - Total: 5'>              case Id_cosh:     arity = 1; name = "cosh";     break;
</span><span class='uc' id='L58' title='5|5|5 - Total: 5'>              case Id_exp:      arity = 1; name = "exp";      break;
</span><span class='uc' id='L59' title='5|5|5 - Total: 5'>              case Id_expm1:    arity = 1; name = "expm1";    break;
</span><span class='uc' id='L60' title='5|5|5 - Total: 5'>              case Id_floor:    arity = 1; name = "floor";    break;
</span><span class='uc' id='L61' title='5|5|5 - Total: 5'>              case Id_hypot:    arity = 2; name = "hypot";    break;
</span><span class='uc' id='L62' title='5|5|5 - Total: 5'>              case Id_imul:     arity = 2; name = "imul";     break;
</span><span class='uc' id='L63' title='5|5|5 - Total: 5'>              case Id_log:      arity = 1; name = "log";      break;
</span><span class='uc' id='L64' title='5|5|5 - Total: 5'>              case Id_log1p:    arity = 1; name = "log1p";    break;
</span><span class='uc' id='L65' title='5|5|5 - Total: 5'>              case Id_log10:    arity = 1; name = "log10";    break;
</span><span class='uc' id='L66' title='5|5|5 - Total: 5'>              case Id_max:      arity = 2; name = "max";      break;
</span><span class='uc' id='L67' title='5|5|5 - Total: 5'>              case Id_min:      arity = 2; name = "min";      break;
</span><span class='uc' id='L68' title='5|5|5 - Total: 5'>              case Id_pow:      arity = 2; name = "pow";      break;
</span><span class='uc' id='L69' title='5|5|5 - Total: 5'>              case Id_random:   arity = 0; name = "random";   break;
</span><span class='uc' id='L70' title='5|5|5 - Total: 5'>              case Id_round:    arity = 1; name = "round";    break;
</span><span class='uc' id='L71' title='5|5|5 - Total: 5'>              case Id_sin:      arity = 1; name = "sin";      break;
</span><span class='uc' id='L72' title='5|5|5 - Total: 5'>              case Id_sinh:     arity = 1; name = "sinh";     break;
</span><span class='uc' id='L73' title='5|5|5 - Total: 5'>              case Id_sqrt:     arity = 1; name = "sqrt";     break;
</span><span class='uc' id='L74' title='5|5|5 - Total: 5'>              case Id_tan:      arity = 1; name = "tan";      break;
</span><span class='uc' id='L75' title='5|5|5 - Total: 5'>              case Id_tanh:     arity = 1; name = "tanh";     break;
</span><span class='uc' id='L76' title='5|5|5 - Total: 5'>              case Id_trunc:    arity = 1; name = "trunc";    break;
</span><span class='nc' id='L77' title='0|0|0 - Total: 6'>              default: throw new IllegalStateException(String.valueOf(id));
</span>            }
<span class='uc' id='L79' title='7|7|7 - Total: 7'>            initPrototypeMethod(MATH_TAG, id, name, arity);
</span><span class='uc' id='L80' title='1|1|1 - Total: 1'>        } else {
</span>            String name;
            double x;
<span class='upc' id='L83' title='8|8|8 - Total: 9'>            switch (id) {
</span><span class='uc' id='L84' title='5|5|5 - Total: 5'>              case Id_E:       x = Math.E;             name = "E";       break;
</span><span class='uc' id='L85' title='5|5|5 - Total: 5'>              case Id_PI:      x = Math.PI;            name = "PI";      break;
</span><span class='uc' id='L86' title='5|5|5 - Total: 5'>              case Id_LN10:    x = 2.302585092994046;  name = "LN10";    break;
</span><span class='uc' id='L87' title='5|5|5 - Total: 5'>              case Id_LN2:     x = 0.6931471805599453; name = "LN2";     break;
</span><span class='uc' id='L88' title='5|5|5 - Total: 5'>              case Id_LOG2E:   x = 1.4426950408889634; name = "LOG2E";   break;
</span><span class='uc' id='L89' title='5|5|5 - Total: 5'>              case Id_LOG10E:  x = 0.4342944819032518; name = "LOG10E";  break;
</span><span class='uc' id='L90' title='5|5|5 - Total: 5'>              case Id_SQRT1_2: x = 0.7071067811865476; name = "SQRT1_2"; break;
</span><span class='uc' id='L91' title='5|5|5 - Total: 5'>              case Id_SQRT2:   x = 1.4142135623730951; name = "SQRT2";   break;
</span><span class='nc' id='L92' title='0|0|0 - Total: 6'>              default: throw new IllegalStateException(String.valueOf(id));
</span>            }
<span class='uc' id='L94' title='7|7|7 - Total: 7'>            initPrototypeValue(id, name, ScriptRuntime.wrapNumber(x),
</span>                               DONTENUM | READONLY | PERMANENT);
        }
<span class='uc' id='L97' title='1|1|1 - Total: 1'>    }
</span>
    @Override
    public Object execIdCall(IdFunctionObject f, Context cx, Scriptable scope,
                             Scriptable thisObj, Object[] args)
    {
<span class='upc' id='L103' title='1|1|1 - Total: 2'>        if (!f.hasTag(MATH_TAG)) {
</span><span class='nc' id='L104' title='0|0|0 - Total: 8'>            return super.execIdCall(f, cx, scope, thisObj, args);
</span>        }
        double x;
<span class='uc' id='L107' title='3|3|3 - Total: 3'>        int methodId = f.methodId();
</span><span class='upc' id='L108' title='26|26|26 - Total: 28'>        switch (methodId) {
</span>            case Id_toSource:
<span class='nc' id='L110' title='0|0|0 - Total: 2'>                return "Math";
</span>
            case Id_abs:
<span class='uc' id='L113' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span>                // abs(-0.0) should be 0.0, but -0.0 < 0.0 == false
<span class='uc' id='L115' title='4|4|4 - Total: 4'>                x = (x == 0.0) ? 0.0 : (x < 0.0) ? -x : x;
</span><span class='uc' id='L116' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_acos:
            case Id_asin:
<span class='uc' id='L120' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L121' title='6|6|6 - Total: 6'>                if (x == x && -1.0 <= x && x <= 1.0) {
</span><span class='uc' id='L122' title='2|2|2 - Total: 2'>                    x = (methodId == Id_acos) ? Math.acos(x) : Math.asin(x);
</span>                } else {
<span class='uc' id='L124' title='2|2|2 - Total: 2'>                    x = Double.NaN;
</span>                }
<span class='uc' id='L126' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_atan:
<span class='uc' id='L129' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L130' title='3|3|3 - Total: 3'>                x = Math.atan(x);
</span><span class='uc' id='L131' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_atan2:
<span class='uc' id='L134' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L135' title='6|6|6 - Total: 6'>                x = Math.atan2(x, ScriptRuntime.toNumber(args, 1));
</span><span class='uc' id='L136' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_cbrt:
<span class='uc' id='L139' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L140' title='3|3|3 - Total: 3'>                x = Math.cbrt(x);
</span><span class='uc' id='L141' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_ceil:
<span class='uc' id='L144' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L145' title='3|3|3 - Total: 3'>                x = Math.ceil(x);
</span><span class='uc' id='L146' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_cos:
<span class='uc' id='L149' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L150' title='4|4|4 - Total: 4'>                x = (x == Double.POSITIVE_INFINITY
</span>                     || x == Double.NEGATIVE_INFINITY)
<span class='uc' id='L152' title='2|2|2 - Total: 2'>                    ? Double.NaN : Math.cos(x);
</span><span class='uc' id='L153' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_cosh:
<span class='uc' id='L156' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L157' title='3|3|3 - Total: 3'>                x = Math.cosh(x);
</span><span class='uc' id='L158' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_hypot:
<span class='uc' id='L161' title='4|4|4 - Total: 4'>                x = js_hypot(args);
</span><span class='uc' id='L162' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_exp:
<span class='uc' id='L165' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L166' title='4|4|4 - Total: 4'>                x = (x == Double.POSITIVE_INFINITY) ? x
</span>                    : (x == Double.NEGATIVE_INFINITY) ? 0.0
<span class='uc' id='L168' title='2|2|2 - Total: 2'>                    : Math.exp(x);
</span><span class='uc' id='L169' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_expm1:
<span class='uc' id='L172' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L173' title='3|3|3 - Total: 3'>                x = Math.expm1(x);
</span><span class='uc' id='L174' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_floor:
<span class='uc' id='L177' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L178' title='3|3|3 - Total: 3'>                x = Math.floor(x);
</span><span class='uc' id='L179' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_imul:
<span class='uc' id='L182' title='4|4|4 - Total: 4'>                return js_imul(args);
</span>
            case Id_log:
<span class='uc' id='L185' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span>                // Java's log(<0) = -Infinity; we need NaN
<span class='uc' id='L187' title='2|2|2 - Total: 2'>                x = (x < 0) ? Double.NaN : Math.log(x);
</span><span class='uc' id='L188' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_log1p:
<span class='uc' id='L191' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L192' title='3|3|3 - Total: 3'>                x = Math.log1p(x);
</span><span class='uc' id='L193' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_log10:
<span class='uc' id='L196' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L197' title='3|3|3 - Total: 3'>                x = Math.log10(x);
</span><span class='uc' id='L198' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_max:
            case Id_min:
<span class='uc' id='L202' title='2|2|2 - Total: 2'>                x = (methodId == Id_max)
</span>                    ? Double.NEGATIVE_INFINITY : Double.POSITIVE_INFINITY;
<span class='uc' id='L204' title='2|2|2 - Total: 2'>                for (int i = 0; i != args.length; ++i) {
</span><span class='uc' id='L205' title='5|5|5 - Total: 5'>                    double d = ScriptRuntime.toNumber(args[i]);
</span><span class='uc' id='L206' title='2|2|2 - Total: 2'>                    if (d != d) {
</span><span class='uc' id='L207' title='2|2|2 - Total: 2'>                        x = d; // NaN
</span><span class='uc' id='L208' title='1|1|1 - Total: 1'>                        break;
</span>                    }
<span class='uc' id='L210' title='2|2|2 - Total: 2'>                    if (methodId == Id_max) {
</span>                        // if (x < d) x = d; does not work due to -0.0 >= +0.0
<span class='uc' id='L212' title='5|5|5 - Total: 5'>                        x = Math.max(x, d);
</span>                    } else {
<span class='uc' id='L214' title='4|4|4 - Total: 4'>                        x = Math.min(x, d);
</span>                    }
                }
<span class='uc' id='L217' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_pow:
<span class='uc' id='L220' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L221' title='7|7|7 - Total: 7'>                x = js_pow(x, ScriptRuntime.toNumber(args, 1));
</span><span class='uc' id='L222' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_random:
<span class='uc' id='L225' title='2|2|2 - Total: 2'>                x = Math.random();
</span><span class='uc' id='L226' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_round:
<span class='uc' id='L229' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L230' title='6|6|6 - Total: 6'>                if (x == x && x != Double.POSITIVE_INFINITY
</span>                    && x != Double.NEGATIVE_INFINITY)
                {
                    // Round only finite x
<span class='uc' id='L234' title='3|3|3 - Total: 3'>                    long l = Math.round(x);
</span><span class='uc' id='L235' title='2|2|2 - Total: 2'>                    if (l != 0) {
</span><span class='uc' id='L236' title='4|4|4 - Total: 4'>                        x = l;
</span>                    } else {
                        // We must propagate the sign of d into the result
<span class='uc' id='L239' title='2|2|2 - Total: 2'>                        if (x < 0.0) {
</span><span class='uc' id='L240' title='3|3|3 - Total: 3'>                            x = ScriptRuntime.negativeZero;
</span><span class='uc' id='L241' title='2|2|2 - Total: 2'>                        } else if (x != 0.0) {
</span><span class='uc' id='L242' title='2|2|2 - Total: 2'>                            x = 0.0;
</span>                        }
                    }
<span class='uc' id='L245' title='1|1|1 - Total: 1'>                }
</span>                break;

            case Id_sin:
<span class='uc' id='L249' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L250' title='4|4|4 - Total: 4'>                x = (x == Double.POSITIVE_INFINITY
</span>                     || x == Double.NEGATIVE_INFINITY)
<span class='uc' id='L252' title='2|2|2 - Total: 2'>                    ? Double.NaN : Math.sin(x);
</span><span class='uc' id='L253' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_sinh:
<span class='uc' id='L256' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L257' title='3|3|3 - Total: 3'>                x = Math.sinh(x);
</span><span class='uc' id='L258' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_sqrt:
<span class='uc' id='L261' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L262' title='3|3|3 - Total: 3'>                x = Math.sqrt(x);
</span><span class='uc' id='L263' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_tan:
<span class='uc' id='L266' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L267' title='3|3|3 - Total: 3'>                x = Math.tan(x);
</span><span class='uc' id='L268' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_tanh:
<span class='uc' id='L271' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L272' title='3|3|3 - Total: 3'>                x = Math.tanh(x);
</span><span class='uc' id='L273' title='1|1|1 - Total: 1'>                break;
</span>
            case Id_trunc:
<span class='uc' id='L276' title='4|4|4 - Total: 4'>                x = ScriptRuntime.toNumber(args, 0);
</span><span class='uc' id='L277' title='4|4|4 - Total: 4'>                x = js_trunc(x);
</span><span class='uc' id='L278' title='1|1|1 - Total: 1'>                break;
</span>
<span class='nc' id='L280' title='0|0|0 - Total: 6'>            default: throw new IllegalStateException(String.valueOf(methodId));
</span>        }
<span class='uc' id='L282' title='3|3|3 - Total: 3'>        return ScriptRuntime.wrapNumber(x);
</span>    }

    // See Ecma 15.8.2.13
    private double js_pow(double x, double y) {
        double result;
<span class='uc' id='L288' title='2|2|2 - Total: 2'>        if (y != y) {
</span>            // y is NaN, result is always NaN
<span class='uc' id='L290' title='3|3|3 - Total: 3'>            result = y;
</span><span class='uc' id='L291' title='2|2|2 - Total: 2'>        } else if (y == 0) {
</span>            // Java's pow(NaN, 0) = NaN; we need 1
<span class='uc' id='L293' title='3|3|3 - Total: 3'>            result = 1.0;
</span><span class='uc' id='L294' title='2|2|2 - Total: 2'>        } else if (x == 0) {
</span>            // Many differences from Java's Math.pow
<span class='uc' id='L296' title='2|2|2 - Total: 2'>            if (1 / x > 0) {
</span><span class='uc' id='L297' title='2|2|2 - Total: 2'>                result = (y > 0) ? 0 : Double.POSITIVE_INFINITY;
</span>            } else {
                // x is -0, need to check if y is an odd integer
<span class='uc' id='L300' title='3|3|3 - Total: 3'>                long y_long = (long)y;
</span><span class='uc' id='L301' title='4|4|4 - Total: 4'>                if (y_long == y && (y_long & 0x1) != 0) {
</span><span class='uc' id='L302' title='2|2|2 - Total: 2'>                    result = (y > 0) ? -0.0 : Double.NEGATIVE_INFINITY;
</span>                } else {
<span class='uc' id='L304' title='2|2|2 - Total: 2'>                    result = (y > 0) ? 0.0 : Double.POSITIVE_INFINITY;
</span>                }
<span class='uc' id='L306' title='1|1|1 - Total: 1'>            }
</span>        } else {
<span class='uc' id='L308' title='4|4|4 - Total: 4'>            result = Math.pow(x, y);
</span><span class='uc' id='L309' title='2|2|2 - Total: 2'>            if (result != result) {
</span>                // Check for broken Java implementations that gives NaN
                // when they should return something else
<span class='uc' id='L312' title='2|2|2 - Total: 2'>                if (y == Double.POSITIVE_INFINITY) {
</span><span class='upc' id='L313' title='2|2|2 - Total: 4'>                    if (x < -1.0 || 1.0 < x) {
</span><span class='nc' id='L314' title='0|0|0 - Total: 3'>                        result = Double.POSITIVE_INFINITY;
</span><span class='upc' id='L315' title='3|3|3 - Total: 4'>                    } else if (-1.0 < x && x < 1.0) {
</span><span class='nc' id='L316' title='0|0|0 - Total: 3'>                        result = 0;
</span>                    }
<span class='uc' id='L318' title='2|2|2 - Total: 2'>                } else if (y == Double.NEGATIVE_INFINITY) {
</span><span class='upc' id='L319' title='2|2|2 - Total: 4'>                    if (x < -1.0 || 1.0 < x) {
</span><span class='nc' id='L320' title='0|0|0 - Total: 3'>                        result = 0;
</span><span class='upc' id='L321' title='3|3|3 - Total: 4'>                    } else if (-1.0 < x && x < 1.0) {
</span><span class='nc' id='L322' title='0|0|0 - Total: 3'>                        result = Double.POSITIVE_INFINITY;
</span>                    }
<span class='upc' id='L324' title='1|1|1 - Total: 2'>                } else if (x == Double.POSITIVE_INFINITY) {
</span><span class='nc' id='L325' title='0|0|0 - Total: 2'>                    result = (y > 0) ? Double.POSITIVE_INFINITY : 0.0;
</span><span class='upc' id='L326' title='1|1|1 - Total: 2'>                } else if (x == Double.NEGATIVE_INFINITY) {
</span><span class='nc' id='L327' title='0|0|0 - Total: 3'>                    long y_long = (long)y;
</span><span class='nc' id='L328' title='0|0|0 - Total: 4'>                    if (y_long == y && (y_long & 0x1) != 0) {
</span>                        // y is odd integer
<span class='nc' id='L330' title='0|0|0 - Total: 2'>                        result = (y > 0) ? Double.NEGATIVE_INFINITY : -0.0;
</span>                    } else {
<span class='nc' id='L332' title='0|0|0 - Total: 2'>                        result = (y > 0) ? Double.POSITIVE_INFINITY : 0.0;
</span>                    }
                }
            }
        }
<span class='uc' id='L337' title='2|2|2 - Total: 2'>        return result;
</span>    }

    // Based on code from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/hypot
    private double js_hypot(Object[] args)
    {
<span class='upc' id='L343' title='1|1|1 - Total: 2'>        if (args == null) {
</span><span class='nc' id='L344' title='0|0|0 - Total: 2'>            return 0.0;
</span>        }
<span class='uc' id='L346' title='2|2|2 - Total: 2'>        double y = 0.0;
</span>
<span class='uc' id='L348' title='2|2|2 - Total: 2'>        for (Object o : args) {
</span><span class='uc' id='L349' title='3|3|3 - Total: 3'>            double d = ScriptRuntime.toNumber(o);
</span><span class='upc' id='L350' title='1|1|1 - Total: 2'>            if (d == ScriptRuntime.NaN) {
</span><span class='nc' id='L351' title='0|0|0 - Total: 2'>                return d;
</span>            }
<span class='upc' id='L353' title='2|2|2 - Total: 4'>            if ((d == Double.POSITIVE_INFINITY) || (d == Double.NEGATIVE_INFINITY)) {
</span><span class='nc' id='L354' title='0|0|0 - Total: 2'>                return Double.POSITIVE_INFINITY;
</span>            }
<span class='uc' id='L356' title='6|6|6 - Total: 6'>            y += d * d;
</span>        }
<span class='uc' id='L358' title='3|3|3 - Total: 3'>        return Math.sqrt(y);
</span>    }

    private double js_trunc(double d)
    {
<span class='uc' id='L363' title='2|2|2 - Total: 2'>        return ((d < 0.0) ? Math.ceil(d) : Math.floor(d));
</span>    }

    // From EcmaScript 6 section 20.2.2.19
    private Object js_imul(Object[] args)
    {
<span class='upc' id='L369' title='2|2|2 - Total: 4'>        if ((args == null) || (args.length < 2)) {
</span><span class='nc' id='L370' title='0|0|0 - Total: 3'>            return ScriptRuntime.wrapNumber(ScriptRuntime.NaN);
</span>        }

<span class='uc' id='L373' title='5|5|5 - Total: 5'>        long x = Conversions.toUint32(args[0]);
</span><span class='uc' id='L374' title='5|5|5 - Total: 5'>        long y = Conversions.toUint32(args[1]);
</span><span class='uc' id='L375' title='6|6|6 - Total: 6'>        long product = (x * y) % Conversions.THIRTYTWO_BIT;
</span><span class='uc' id='L376' title='2|2|2 - Total: 2'>        long result = (product >= (1L << 31L)) ? (product - Conversions.THIRTYTWO_BIT) : product;
</span><span class='uc' id='L377' title='5|5|5 - Total: 5'>        return ScriptRuntime.toNumber(result);
</span>    }

// #string_id_map#

    @Override
    protected int findPrototypeId(String s)
    {
        int id;
// #generated# Last update: 2015-06-16 09:41:02 PDT
<span class='uc' id='L387' title='4|4|4 - Total: 4'>        L0: { id = 0; String X = null; int c;
</span><span class='uc' id='L388' title='9|9|9 - Total: 9'>            L: switch (s.length()) {
</span><span class='upc' id='L389' title='1|1|1 - Total: 2'>            case 1: if (s.charAt(0)=='E') {id=Id_E; break L0;} break L;
</span><span class='upc' id='L390' title='2|2|2 - Total: 4'>            case 2: if (s.charAt(0)=='P' && s.charAt(1)=='I') {id=Id_PI; break L0;} break L;
</span><span class='upc' id='L391' title='9|9|9 - Total: 10'>            case 3: switch (s.charAt(0)) {
</span><span class='upc' id='L392' title='2|2|2 - Total: 4'>                case 'L': if (s.charAt(2)=='2' && s.charAt(1)=='N') {id=Id_LN2; break L0;} break L;
</span><span class='upc' id='L393' title='2|2|2 - Total: 4'>                case 'a': if (s.charAt(2)=='s' && s.charAt(1)=='b') {id=Id_abs; break L0;} break L;
</span><span class='upc' id='L394' title='2|2|2 - Total: 4'>                case 'c': if (s.charAt(2)=='s' && s.charAt(1)=='o') {id=Id_cos; break L0;} break L;
</span><span class='upc' id='L395' title='2|2|2 - Total: 4'>                case 'e': if (s.charAt(2)=='p' && s.charAt(1)=='x') {id=Id_exp; break L0;} break L;
</span><span class='upc' id='L396' title='2|2|2 - Total: 4'>                case 'l': if (s.charAt(2)=='g' && s.charAt(1)=='o') {id=Id_log; break L0;} break L;
</span><span class='uc' id='L397' title='4|4|4 - Total: 4'>                case 'm': c=s.charAt(2);
</span><span class='upc' id='L398' title='3|3|3 - Total: 4'>                    if (c=='n') { if (s.charAt(1)=='i') {id=Id_min; break L0;} }
</span><span class='upc' id='L399' title='2|2|2 - Total: 4'>                    else if (c=='x') { if (s.charAt(1)=='a') {id=Id_max; break L0;} }
</span>                    break L;
<span class='upc' id='L401' title='2|2|2 - Total: 4'>                case 'p': if (s.charAt(2)=='w' && s.charAt(1)=='o') {id=Id_pow; break L0;} break L;
</span><span class='upc' id='L402' title='2|2|2 - Total: 4'>                case 's': if (s.charAt(2)=='n' && s.charAt(1)=='i') {id=Id_sin; break L0;} break L;
</span><span class='upc' id='L403' title='2|2|2 - Total: 4'>                case 't': if (s.charAt(2)=='n' && s.charAt(1)=='a') {id=Id_tan; break L0;} break L;
</span><span class='nc' id='L404' title='0|0|0 - Total: 1'>                } break L;
</span><span class='upc' id='L405' title='11|11|11 - Total: 12'>            case 4: switch (s.charAt(1)) {
</span><span class='uc' id='L406' title='5|5|5 - Total: 5'>                case 'N': X="LN10";id=Id_LN10; break L;
</span><span class='uc' id='L407' title='5|5|5 - Total: 5'>                case 'a': X="tanh";id=Id_tanh; break L;
</span><span class='uc' id='L408' title='5|5|5 - Total: 5'>                case 'b': X="cbrt";id=Id_cbrt; break L;
</span><span class='uc' id='L409' title='5|5|5 - Total: 5'>                case 'c': X="acos";id=Id_acos; break L;
</span><span class='uc' id='L410' title='5|5|5 - Total: 5'>                case 'e': X="ceil";id=Id_ceil; break L;
</span><span class='uc' id='L411' title='5|5|5 - Total: 5'>                case 'i': X="sinh";id=Id_sinh; break L;
</span><span class='uc' id='L412' title='5|5|5 - Total: 5'>                case 'm': X="imul";id=Id_imul; break L;
</span><span class='uc' id='L413' title='5|5|5 - Total: 5'>                case 'o': X="cosh";id=Id_cosh; break L;
</span><span class='uc' id='L414' title='5|5|5 - Total: 5'>                case 'q': X="sqrt";id=Id_sqrt; break L;
</span><span class='uc' id='L415' title='5|5|5 - Total: 5'>                case 's': X="asin";id=Id_asin; break L;
</span><span class='uc' id='L416' title='5|5|5 - Total: 5'>                case 't': X="atan";id=Id_atan; break L;
</span><span class='nc' id='L417' title='0|0|0 - Total: 1'>                } break L;
</span><span class='uc' id='L418' title='10|10|10 - Total: 10'>            case 5: switch (s.charAt(0)) {
</span><span class='uc' id='L419' title='5|5|5 - Total: 5'>                case 'L': X="LOG2E";id=Id_LOG2E; break L;
</span><span class='uc' id='L420' title='5|5|5 - Total: 5'>                case 'S': X="SQRT2";id=Id_SQRT2; break L;
</span><span class='uc' id='L421' title='5|5|5 - Total: 5'>                case 'a': X="atan2";id=Id_atan2; break L;
</span><span class='uc' id='L422' title='5|5|5 - Total: 5'>                case 'e': X="expm1";id=Id_expm1; break L;
</span><span class='uc' id='L423' title='5|5|5 - Total: 5'>                case 'f': X="floor";id=Id_floor; break L;
</span><span class='uc' id='L424' title='5|5|5 - Total: 5'>                case 'h': X="hypot";id=Id_hypot; break L;
</span><span class='uc' id='L425' title='4|4|4 - Total: 4'>                case 'l': c=s.charAt(4);
</span><span class='uc' id='L426' title='2|2|2 - Total: 2'>                    if (c=='0') { X="log10";id=Id_log10; }
</span><span class='upc' id='L427' title='1|1|1 - Total: 2'>                    else if (c=='p') { X="log1p";id=Id_log1p; }
</span>                    break L;
<span class='uc' id='L429' title='5|5|5 - Total: 5'>                case 'r': X="round";id=Id_round; break L;
</span><span class='uc' id='L430' title='5|5|5 - Total: 5'>                case 't': X="trunc";id=Id_trunc; break L;
</span><span class='uc' id='L431' title='1|1|1 - Total: 1'>                } break L;
</span><span class='uc' id='L432' title='4|4|4 - Total: 4'>            case 6: c=s.charAt(0);
</span><span class='uc' id='L433' title='2|2|2 - Total: 2'>                if (c=='L') { X="LOG10E";id=Id_LOG10E; }
</span><span class='upc' id='L434' title='1|1|1 - Total: 2'>                else if (c=='r') { X="random";id=Id_random; }
</span>                break L;
<span class='uc' id='L436' title='5|5|5 - Total: 5'>            case 7: X="SQRT1_2";id=Id_SQRT1_2; break L;
</span><span class='uc' id='L437' title='5|5|5 - Total: 5'>            case 8: X="toSource";id=Id_toSource; break L;
</span>            }
<span class='uc' id='L439' title='6|6|6 - Total: 6'>            if (X!=null && X!=s && !X.equals(s)) id = 0;
</span>            break L0;
        }
// #/generated#
<span class='uc' id='L443' title='2|2|2 - Total: 2'>        return id;
</span>    }

    private static final int
        Id_toSource     =  1,
        Id_abs          =  2,
        Id_acos         =  3,
        Id_asin         =  4,
        Id_atan         =  5,
        Id_atan2        =  6,
        Id_ceil         =  7,
        Id_cos          =  8,
        Id_exp          =  9,
        Id_floor        = 10,
        Id_log          = 11,
        Id_max          = 12,
        Id_min          = 13,
        Id_pow          = 14,
        Id_random       = 15,
        Id_round        = 16,
        Id_sin          = 17,
        Id_sqrt         = 18,
        Id_tan          = 19,
        Id_cbrt         = 20,
        Id_cosh         = 21,
        Id_expm1        = 22,
        Id_hypot        = 23,
        Id_log1p        = 24,
        Id_log10        = 25,
        Id_sinh         = 26,
        Id_tanh         = 27,
        Id_imul         = 28,
        Id_trunc        = 29,

        LAST_METHOD_ID  = Id_trunc;

/* Missing from ES6:
    acosh
    asinh
    atanh
    clz32
    fround
    log2
 */

    private static final int
        Id_E            = LAST_METHOD_ID + 1,
        Id_PI           = LAST_METHOD_ID + 2,
        Id_LN10         = LAST_METHOD_ID + 3,
        Id_LN2          = LAST_METHOD_ID + 4,
        Id_LOG2E        = LAST_METHOD_ID + 5,
        Id_LOG10E       = LAST_METHOD_ID + 6,
        Id_SQRT1_2      = LAST_METHOD_ID + 7,
        Id_SQRT2        = LAST_METHOD_ID + 8,

        MAX_ID = LAST_METHOD_ID + 8;

// #/string_id_map#
}
</pre></body></html><table class='legend'><tr><td class='nc'>Not Covered</td><td class='ac'>Covered by test suite 1</td><td class='bc'>Covered by test suite 2</td><td class='uc'>Covered by the union test suite</td><td class='apc'>Partially Covered by test suite 1</td><td class='bpc'>Partially Covered by test suite 2</td><td class='upc'>Partially Covered by the union test suite</td></tr></table>